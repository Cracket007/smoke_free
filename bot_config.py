import telebot
import os
from dotenv import load_dotenv
import random
from telebot import types
from datetime import datetime
import pytz

load_dotenv()
TOKEN = os.getenv('BOT_TOKEN')

# Устанавливаем киевский часовой пояс
TIMEZONE = pytz.timezone('Europe/Kiev')

def get_current_time():
    """Получить текущее время в киевском часовом поясе"""
    return datetime.now(TIMEZONE)

if TOKEN is None:
    raise ValueError("Не найден BOT_TOKEN в файле .env")

bot = telebot.TeleBot(TOKEN)

# User data
users = {}

# Audio file paths
audio_files = {
    # Вступительная фраза
    "intro": "audio/intro.ogg",  # "Вы уже не курите"
    
    # Базовые числа (1-20, 30)
    "numbers": {str(i): f"audio/{i}.ogg" for i in range(1, 21)},
    "twenty": "audio/20.ogg",
    "thirty": "audio/30.ogg",
    
    # Слова для лет
    "year_forms": {
        "singular": "audio/year.ogg",     # год
        "few": "audio/years2-4.ogg",      # года
        "plural": "audio/years.ogg"       # лет
    },
    
    # Слова для месяцев
    "month_forms": {
        "singular": "audio/month.ogg",    # месяц
        "few": "audio/months2-4.ogg",     # месяца
        "plural": "audio/months.ogg"      # месяцев
    },
    
    # Слова для дней
    "day_forms": {
        "singular": "audio/day.ogg",      # день
        "few": "audio/days2-4.ogg",       # дня
        "plural": "audio/days.ogg"        # дней
    },
    
    # Слова для часов
    "hour_forms": {
        "singular": "audio/hour.ogg",     # час
        "few": "audio/hours2-4.ogg",      # часа
        "plural": "audio/hours.ogg"       # часов
    },
    
    # Соединительные слова
    "and": "audio/and.ogg",
    
    # Мотивирующие фразы
    "motivation": {
        "phrase1": "audio/phrase1.ogg",  # Я горжусь тобой!
        "phrase2": "audio/phrase2.ogg",  # Вы молодец!
        "phrase3": "audio/phrase3.ogg",  # Так держать!
        "phrase4": "audio/phrase4.ogg",  # Каждый день - это победа!
        "phrase5": "audio/phrase5.ogg",  # Ты сделал правильный выбор!
        "phrase6": "audio/phrase6.ogg",  # Это достойно уважения!
        "phrase7": "audio/phrase7.ogg",  # У тебя отлично получается!
        "phrase8": "audio/phrase8.ogg",  # Продолжайте в том же духе!
        "phrase9": "audio/phrase9.ogg",  # Я вами горжусь!
        "phrase10": "audio/phrase10.ogg"   # Вы такие умнички!
    }
} 

# Мотивационные фразы для голосовых сообщений
voice_motivation_phrases = [
    "Я горжусь тобой!",
    "Вы молодец!",
    "Так держать!",
    "Каждый день - это победа!",
    "Ты сделал правильный выбор!",
    "Это достойно уважения!",
    "У тебя отлично получается!",
    "Продолжайте в том же духе!",
    "Я вами горжусь!",
    "Вы такие умнички!"
]

# Мотивационные фразы для текстовых сообщений
text_motivation_phrases = [
    # Существующие фразы оставляем
    "Твои лёгкие говорят спасибо! 🫁",
    "Ты выбрал здоровье - это круто! ❤️",
    "С каждым днём ты дышишь свободнее! 🌬️",
    "Твоё тело восстанавливается! 💪",
    "Здоровье дороже любой сигареты! 🏃",
    "Копилка пополняется! 💰",
    "Деньги теперь на что-то приятное! 💎",
    "Экономия - приятный бонус! 🤑",
    "Инвестиции в себя окупаются! 📈",
    "Сигареты? Не, не слышал! 🙉",
    "Никотину здесь не рады! ��",
    "Дым? Только от шашлыков! 🍖",
    "Затяжка? Только свежим воздухом! 🌳",
    "Ты настоящий чемпион! 🏆",
    "Гордимся твоей силой воли! 👊",
    "Это достойно уважения! 🎖️",
    "Ты пример для других! 🌟",
    "Сигаретам пора на пенсию! 👋",
    "Никотин плачет по тебе! 😢",
    "Табачные компании в печали! 📉",
    "Пачка курит в сторонке! 😎",
    "Вкус и запах возвращаются! 👃",
    "Кожа сияет, лёгкие поют! ✨",
    "Зубы белее, улыбка шире! 😁",
    "Ты пахнешь свободой! 🌸",
    "Невозможное возможно! 🚀",
    "Ты круче, чем вчера! 📈",
    "Сила воли level up! 🆙",
    "Новый уровень разблокирован! 🎮",
    "Послал курение куда подальше! 🖕",
    "Никотин? Нахрен надо! 😤",
    "Сигаретам здесь не место! 💪",
    "Зависимость отправлена в бан! 🚫",
    "Светлое будущее впереди! 🌅",
    "Каждый день всё лучше! ⭐",
    "Ты на правильном пути! 🛣️",
    "Будущее без дыма прекрасно! 🌈",
    
    # Добавляем новые фразы
    # Здоровье
    "🫁 Твои лёгкие уже благодарят тебя!",
    "💪 С каждым днем ты становишься сильнее",
    "🧬 Твоё тело восстанавливается с каждым часом",
    "🏃‍♂️ Теперь ты можешь бегать без одышки",
    "❤️ Твоё сердце работает как часы",
    "🦾 Иммунитет крепчает день ото дня",
    "🧘‍♂️ Чувствуешь, как легко дышится?",
    
    # Внешность и отношения
    "😎 Ты выглядишь моложе с каждым днем",
    "🌟 От тебя больше не пахнет пепельницей",
    "✨ Твоя кожа становится чище",
    "🦷 Зубы становятся белее",
    "👔 Вся одежда теперь пахнет свежестью",
    
    # Мужское здоровье с юмором
    "🚀 Твоя мужская сила растет как на дрожжах",
    "💪 Потенция как у молодого жеребца",
    "🎯 Теперь ты попадаешь во все цели",
    "🦁 Ты становишься настоящим львом",
    "🐯 Тигр в постели - это про тебя",
    "🎪 Твой цирк теперь работает без антракта",
    "🎭 Твоё представление всегда с аншлагом",
    "�� Твой стержень крепче стали",
    "🎯 Теперь ты стреляешь без осечек",
    "🚀 Ракета всегда готова к взлёту",
    "💪 Батарейка энерджайзер нервно курит",
    "🦾 Теперь ты терминатор в постели",
    "🎪 Твой спектакль идёт на бис",
    "🎭 Зрители требуют продолжения",
    "🦁 Царь зверей позавидует",
    "🐯 Тестостерон зашкаливает",
    
    # Отношения с юмором
    "👩 Девушки замечают, как ты похорошел",
    "💃 Дамы оборачиваются тебе вслед",
    "💋 Поцелуи стали вкуснее",
    "🌹 Ты стал настоящим магнитом",
    "💘 Амур теперь на твоей стороне",
    "🎭 Ты главный герой любовного романа",
    "💋 Девчонки выстраиваются в очередь",
    "💃 Красотки теряют голову",
    "🌹 Ты как Казанова, только лучше",
    "💘 Купидон взял тебя в напарники",
    "🎭 Ты звезда любовного сериала",
    "👑 Все принцессы твои",
    "💫 Красотки сходят с ума",
    "🌟 Ты теперь первый парень на деревне",
    "💝 Любовь находит тебя сама",
    "💞 Сердцеед - твое второе имя",
    "👔 Ты теперь завидный жених",
    "🎪 От поклонниц нет отбоя",
    "🌺 Цветы сами распускаются при твоем появлении",
    "💫 Ты как магнит для красоток",
    
    # Провокационные
    "😎 Ты теперь горячее любого окурка",
    "💪 Дым уже не твой формат",
    "🚀 Ты взлетел выше любого дыма",
    "🎯 Точно в цель - жизнь без табака",
    "🦁 Ты укротил свою зависимость",
    
    # Саркастичные
    "😏 Табачные магнаты плачут без тебя",
    "😎 Ты слишком крут для этой привычки",
    "🎭 Сигареты остались в прошлом веке",
    "🚀 Ты вышел на новый уровень игры",
    "💫 Теперь ты дышишь свободой"
]

def get_voice_motivation():
    """Получить случайную фразу и ключ для голосового сообщения"""
    phrase = random.choice(voice_motivation_phrases)
    # Маппинг фраз на ключи аудиофайлов
    phrase_to_key = {
        "Я горжусь тобой!": "phrase1",
        "Вы молодец!": "phrase2",
        "Так держать!": "phrase3",
        "Каждый день - это победа!": "phrase4",
        "Ты сделал правильный выбор!": "phrase5",
        "Это достойно уважения!": "phrase6",
        "У тебя отлично получается!": "phrase7",
        "Продолжайте в том же духе!": "phrase8",
        "Я вами горжусь!": "phrase9",
        "Вы такие умнички!": "phrase10"
    }
    return phrase, phrase_to_key[phrase]

def get_text_motivation():
    """Получить две случайные фразы для текстового сообщения"""
    return f"{random.choice(text_motivation_phrases)}\n{random.choice(text_motivation_phrases)}" 